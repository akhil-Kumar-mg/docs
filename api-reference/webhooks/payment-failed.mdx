---
title: "PAYMENT_FAILED Webhook"
description: "Technical reference for the PAYMENT_FAILED webhook event, including payload schema, field specifications, and implementation details."
---

---

## üìã Event Overview

**Event Type**: `PAYMENT_FAILED`  
**Category**: Payment  
**Description**: Payment transaction has failed

This webhook is triggered when a customer's payment attempt fails through EximPe.

---

## üìä Payload Schema

```json
{
    "event_type": "PAYMENT_FAILED",
    "event_time": "2024-02-15 16:53:15Z",
    "version": "1.0",
    "data": {
        "id": "PR2594743053",
        "merchant": {
            "id": "6889114728",
            "name": "Herring Lt"
        },
        "reference_id": "TEST_UAYJWL",
        "buyer": {
            "name": "John Doe",
            "email": "john.doe@example.com",
            "phone": "+919876543210"
        },
        "order_id": "OD3119565151",
        "amount": {
            "amount": 1000.0,
            "total_amount": 1000.0,
            "currency": "INR"
        },
        "created_at": "2025-06-23T15:43:29.632246Z",
        "status": "FAILED",
        "comment": "Invalid mpin",
        "preferred_method": "UPI",
        "mop_type": "UPI",
        "settlement_status": "PAYMENT_PENDING"
    }
}
```

---

## üîç Field Specifications

### Root Level Fields

| **Field** | **Type** | **Required** | **Description** |
|-----------|----------|--------------|-----------------|
| `event_type` | `string` | ‚úÖ | Always `"PAYMENT_FAILED"` |
| `event_time` | `string` | ‚úÖ | Timestamp when the event occurred (ISO 8601 format) |
| `version` | `string` | ‚úÖ | Webhook payload version (currently "1.0") |
| `data` | `object` | ‚úÖ | Event-specific data payload |

### Data Object Fields

| **Field** | **Type** | **Required** | **Description** |
|-----------|----------|--------------|-----------------|
| `id` | `string` | ‚úÖ | Payment request ID |
| `merchant.id` | `string` | ‚úÖ | Merchant ID |
| `merchant.name` | `string` | ‚úÖ | Merchant name |
| `reference_id` | `string` | ‚úÖ | Reference ID for the payment |
| `buyer.name` | `string` | ‚úÖ | Buyer's name |
| `buyer.email` | `string` | ‚úÖ | Buyer's email |
| `buyer.phone` | `string` | ‚úÖ | Buyer's phone number |
| `order_id` | `string` | ‚úÖ | Order ID |
| `amount.amount` | `number` | ‚úÖ | Payment amount |
| `amount.total_amount` | `number` | ‚úÖ | Total amount including fees |
| `amount.currency` | `string` | ‚úÖ | Currency code |
| `created_at` | `string` | ‚úÖ | ISO 8601 creation timestamp |
| `status` | `string` | ‚úÖ | Payment status (FAILED) |
| `comment` | `string` | ‚úÖ | Failure reason or comment |
| `preferred_method` | `string` | ‚úÖ | Preferred payment method |
| `mop_type` | `string` | ‚úÖ | Method of payment type |
| `settlement_status` | `string` | ‚úÖ | Current settlement status |

---

## üõ†Ô∏è Implementation Examples

### JavaScript/Node.js

```javascript
app.post('/webhook', (req, res) => {
    const { event_type, data } = req.body;
    
    if (event_type === 'PAYMENT_FAILED') {
        const {
            id,
            merchant,
            reference_id,
            buyer,
            order_id,
            amount,
            created_at,
            status,
            comment,
            preferred_method,
            mop_type,
            settlement_status
        } = data;
        
        // Handle failed payment
        console.log(`Payment ${id} failed for order ${order_id}`);
        console.log(`Failure reason: ${comment}`);
        console.log(`Buyer: ${buyer.name} (${buyer.email})`);
        
        // Update order status
        await updateOrderStatus(order_id, 'payment_failed');
        
        // Send failure notification
        await sendFailureNotification(buyer.email, order_id, comment);
        
        // Log failure
        await logPaymentFailure({
            payment_id: id,
            order_id,
            amount: amount.amount,
            currency: amount.currency,
            method: mop_type,
            failure_reason: comment,
            buyer_email: buyer.email
        });
    }
    
    res.status(200).send('OK');
});
```

### Python

```python
@app.route('/webhook', methods=['POST'])
def webhook_handler():
    data = request.get_json()
    event_type = data.get('event_type')
    
    if event_type == 'PAYMENT_FAILED':
        webhook_data = data.get('data')
        
        payment_id = webhook_data.get('id')
        order_id = webhook_data.get('order_id')
        buyer = webhook_data.get('buyer')
        amount = webhook_data.get('amount')
        comment = webhook_data.get('comment')
        
        # Handle failed payment
        print(f"Payment {payment_id} failed for order {order_id}")
        print(f"Failure reason: {comment}")
        print(f"Buyer: {buyer['name']} ({buyer['email']})")
        
        # Update order status
        update_order_status(order_id, 'payment_failed')
        
        # Send failure notification
        send_failure_notification(buyer['email'], order_id, comment)
        
        # Log failure
        log_payment_failure({
            'payment_id': payment_id,
            'order_id': order_id,
            'amount': amount['amount'],
            'currency': amount['currency'],
            'method': webhook_data.get('mop_type'),
            'failure_reason': comment,
            'buyer_email': buyer['email']
        })
    
    return jsonify({'status': 'OK'}), 200
```

### PHP

```php
<?php
$webhook_data = json_decode(file_get_contents('php://input'), true);
$event_type = $webhook_data['event_type'];

if ($event_type === 'PAYMENT_FAILED') {
    $data = $webhook_data['data'];
    
    $payment_id = $data['id'];
    $order_id = $data['order_id'];
    $buyer = $data['buyer'];
    $amount = $data['amount'];
    $comment = $data['comment'];
    
    // Handle failed payment
    error_log("Payment {$payment_id} failed for order {$order_id}");
    error_log("Failure reason: {$comment}");
    error_log("Buyer: {$buyer['name']} ({$buyer['email']})");
    
    // Update order status
    updateOrderStatus($order_id, 'payment_failed');
    
    // Send failure notification
    sendFailureNotification($buyer['email'], $order_id, $comment);
    
    // Log failure
    logPaymentFailure([
        'payment_id' => $payment_id,
        'order_id' => $order_id,
        'amount' => $amount['amount'],
        'currency' => $amount['currency'],
        'method' => $data['mop_type'],
        'failure_reason' => $comment,
        'buyer_email' => $buyer['email']
    ]);
}

http_response_code(200);
echo json_encode(['status' => 'OK']);
?>
```

---

## üìã Business Logic Recommendations

When you receive this webhook, consider implementing the following:

### 1. Verify Payment Status
```javascript
// Ensure payment is actually failed
if (status !== 'FAILED') {
    console.error(`Unexpected payment status: ${status}`);
    return;
}
```

### 2. Update Order Status
```javascript
// Update order status to payment failed
await updateOrderStatus(order_id, 'payment_failed');
await updateOrderPaymentInfo(order_id, {
    payment_id: id,
    amount: amount.amount,
    currency: amount.currency,
    method: mop_type,
    failed_at: created_at,
    failure_reason: comment
});
```

### 3. Notify Customer
```javascript
// Send failure notification to customer
await sendFailureNotification(buyer.email, {
    order_id,
    amount: amount.amount,
    currency: amount.currency,
    buyer_name: buyer.name,
    failure_reason: comment,
    retry_url: generateRetryUrl(order_id)
});
```

### 4. Handle Inventory
```javascript
// Restore inventory if items were reserved
await restoreInventoryForOrder(order_id);
await markItemsAsAvailable(order_id);
```

### 5. Log for Analytics
```javascript
// Log failure for analytics and reporting
await logPaymentEvent({
    event: 'payment_failed',
    payment_id: id,
    order_id,
    merchant_id: merchant.id,
    amount: amount.amount,
    currency: amount.currency,
    method: mop_type,
    failure_reason: comment,
    buyer_email: buyer.email,
    timestamp: created_at
});
```

### 6. Retry Logic
```javascript
// Implement retry logic if appropriate
if (shouldRetryPayment(comment)) {
    await schedulePaymentRetry(order_id, buyer.email);
}
```

---

## üìä Status Values

### Payment Status
- `FAILED` - Payment attempt failed

### Settlement Status
- `PAYMENT_PENDING` - Payment pending (failed)

### Payment Methods
- `UPI` - Unified Payments Interface
- `CARD` - Credit/Debit Card
- `NETBANKING` - Net Banking
- `WALLET` - Digital Wallet

### Common Failure Reasons
- `Invalid mpin` - Invalid UPI PIN
- `Insufficient funds` - Insufficient account balance
- `Transaction declined` - Bank declined the transaction
- `Network error` - Network connectivity issues
- `Timeout` - Transaction timed out

---

## ‚ö†Ô∏è Important Notes

- **Idempotency**: This webhook may be sent multiple times. Ensure your handling logic is idempotent.
- **Verification**: Always verify the webhook signature before processing.
- **Failure Analysis**: Use the `comment` field to understand the failure reason.
- **Customer Communication**: Provide clear, helpful messages to customers about the failure.
- **Retry Strategy**: Consider implementing a retry mechanism for transient failures.
- **Error Handling**: Log any errors and return appropriate HTTP status codes.

---

## üîó Related Documentation

- [Webhooks Overview](/api-reference/webhooks)
- [PAYMENT_SUCCESSFUL Webhook](/api-reference/webhooks/payment-successful)
- [PAYMENT_REFUNDED Webhook](/api-reference/webhooks/payment-refunded)
- [Signature Verification](/api-reference/webhooks#authentication)

---

For technical support, contact [engineering@eximpe.com](mailto:engineering@eximpe.com). 