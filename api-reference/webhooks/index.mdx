---
title: "Webhooks API Reference"
description: "Complete technical reference for EximPe webhook events, including payload schemas, field specifications, and implementation details for developers."
---

---

## üìã Overview

EximPe webhooks are HTTP POST requests sent to your configured endpoint when payment events occur. Each webhook contains a signed payload with event-specific data.

### Request Format

- **Method**: `POST`
- **Content-Type**: `application/x-www-form-urlencoded` or `multipart/form-data`
- **Headers**: Include `x-signature` for verification
- **Response**: Must return `200 OK`

### Retry Logic

- **Retry Attempts**: 3 times
- **Retry Interval**: Exponential backoff
- **Success Criteria**: 200 OK response

---

## üîê Authentication

### Signature Verification

EximPe signs webhooks using HMAC-SHA256. The signature is included in the `x-signature` header.

#### Verification Process

1. **Extract message parts** from the webhook payload
2. **Join parts** using `|` as separator
3. **Generate HMAC** using your encryption key and SHA-256
4. **Compare** with the received signature

#### Implementation Example

```javascript
const crypto = require('crypto');

function verifyWebhookSignature(payload, receivedSignature, encryptionKey) {
    // Extract message parts (implementation depends on your payload structure)
    const messageParts = extractMessageParts(payload);
    const message = messageParts.join('|');
    
    // Generate signature
    const generatedSignature = crypto
        .createHmac('sha256', encryptionKey)
        .update(message)
        .digest('hex');
    
    return generatedSignature === receivedSignature;
}
```

---

## üìä Webhook Events

| **Event** | **Category** | **Description** | **Documentation** |
|-----------|--------------|-----------------|-------------------|
| **MERCHANT_APPROVED** | Onboarding | Merchant account approved | [View Details](/api-reference/webhooks/merchant-approved) |
| **PAYMENT_SUCCESSFUL** | Payment | Payment transaction successful | [View Details](/api-reference/webhooks/payment-successful) |
| **PAYMENT_FAILED** | Payment | Payment transaction failed | [View Details](/api-reference/webhooks/payment-failed) |
| **PAYMENT_REFUNDED** | Payment | Payment refunded | [View Details](/api-reference/webhooks/payment-refunded) |
| **PAYMENT_SETTLED** | Settlement | Settlement completed | [View Details](/api-reference/webhooks/payment-settled) |

---

## üõ†Ô∏è Implementation Examples

### Node.js Express Handler

```javascript
const express = require('express');
const crypto = require('crypto');

const app = express();
app.use(express.json());

app.post('/webhook', (req, res) => {
    try {
        const { event_type, data } = req.body;
        const signature = req.headers['x-signature'];
        
        // Verify signature
        if (!verifySignature(req.body, signature, process.env.WEBHOOK_KEY)) {
            return res.status(401).send('Invalid signature');
        }
        
        // Handle different event types
        switch (event_type) {
            case 'PAYMENT_SUCCESSFUL':
                handlePaymentSuccess(data);
                break;
            case 'PAYMENT_FAILED':
                handlePaymentFailure(data);
                break;
            case 'PAYMENT_REFUNDED':
                handlePaymentRefund(data);
                break;
            case 'MERCHANT_APPROVED':
                handleMerchantApproval(data);
                break;
            case 'PAYMENT_SETTLED':
                handleSettlement(data);
                break;
            default:
                console.log(`Unknown event type: ${event_type}`);
        }
        
        res.status(200).send('OK');
    } catch (error) {
        console.error('Webhook processing error:', error);
        res.status(500).send('Internal server error');
    }
});

function handlePaymentSuccess(data) {
    const { id, order_id, amount, buyer } = data;
    console.log(`Payment ${id} successful for order ${order_id}`);
    // Implement your business logic here
}
```

### Python Flask Handler

```python
from flask import Flask, request, jsonify
import hmac
import hashlib
import json

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def webhook_handler():
    try:
        # Get webhook data
        data = request.get_json()
        signature = request.headers.get('x-signature')
        
        # Verify signature
        if not verify_signature(data, signature, app.config['WEBHOOK_KEY']):
            return jsonify({'error': 'Invalid signature'}), 401
        
        event_type = data.get('event_type')
        webhook_data = data.get('data')
        
        # Handle different event types
        if event_type == 'PAYMENT_SUCCESSFUL':
            handle_payment_success(webhook_data)
        elif event_type == 'PAYMENT_FAILED':
            handle_payment_failure(webhook_data)
        elif event_type == 'PAYMENT_REFUNDED':
            handle_payment_refund(webhook_data)
        elif event_type == 'MERCHANT_APPROVED':
            handle_merchant_approval(webhook_data)
        elif event_type == 'PAYMENT_SETTLED':
            handle_settlement(webhook_data)
        
        return jsonify({'status': 'OK'}), 200
        
    except Exception as e:
        print(f"Webhook processing error: {e}")
        return jsonify({'error': 'Internal server error'}), 500

def verify_signature(data, received_signature, secret_key):
    # Implement signature verification logic
    message = json.dumps(data, separators=(',', ':'))
    expected_signature = hmac.new(
        secret_key.encode(),
        message.encode(),
        hashlib.sha256
    ).hexdigest()
    
    return hmac.compare_digest(expected_signature, received_signature)

def handle_payment_success(data):
    payment_id = data.get('id')
    order_id = data.get('order_id')
    print(f"Payment {payment_id} successful for order {order_id}")
    # Implement your business logic here
```

---

## üìä Status Codes & Values

### Payment Status Values

| **Status** | **Description** |
|------------|-----------------|
| `CAPTURED` | Payment successfully captured |
| `FAILED` | Payment attempt failed |
| `PENDING` | Payment is pending |
| `CANCELLED` | Payment was cancelled |

### Settlement Status Values

| **Status** | **Description** |
|------------|-----------------|
| `READY_FOR_SETTLEMENT` | Payment ready for settlement |
| `SETTLEMENT_PENDING` | Settlement in progress |
| `SETTLED` | Settlement completed |
| `PAYMENT_PENDING` | Payment pending |

### Payment Methods

| **Method** | **Description** |
|------------|-----------------|
| `UPI` | Unified Payments Interface |
| `CARD` | Credit/Debit Card |
| `NETBANKING` | Net Banking |
| `WALLET` | Digital Wallet |

---

## ‚ö†Ô∏è Error Handling

### Common Error Scenarios

1. **Invalid Signature**: Return 401 Unauthorized
2. **Malformed Payload**: Return 400 Bad Request
3. **Processing Error**: Return 500 Internal Server Error
4. **Success**: Return 200 OK

### Best Practices

- **Always verify signatures** before processing
- **Log all webhook events** for debugging
- **Handle all event types** even if not used
- **Return appropriate HTTP status codes**
- **Implement idempotency** to handle duplicate webhooks
- **Use HTTPS endpoints** only

---

For technical support, contact [engineering@eximpe.com](mailto:engineering@eximpe.com). 